{
  "feature_name": "getSavedCards契約の明確化: サインアップ直後の空配列動作を文書化",
  "status": "in_progress",
  "api_changes": [
    {
      "endpoint": "getSavedCards",
      "change_type": "documentation_clarification",
      "field": "savedCards",
      "before": "空配列の場合について記載なし",
      "after": "サインアップ直後は空配列を返すことを明記。レスポンス例を追加。",
      "breaking": false,
      "reason": "クライアント開発者が空配列を想定せずエラー処理を実装していた可能性。契約の不備を修正。"
    }
  ],
  "tests_required": [
    {
      "test_file": "savedCard.integration.test.ts",
      "test_name": "サインアップ直後（saved_cards空）でgetSavedCardsを呼ぶと空配列を返す",
      "status": "to_be_created",
      "action": "新規作成"
    },
    {
      "test_file": "savedCard.integration.test.ts",
      "test_name": "フィルタ適用時に結果が0件の場合も空配列を返す",
      "status": "to_be_created",
      "action": "新規作成"
    }
  ],
  "client_work_items": [
    {
      "platform": "web",
      "task": "空配列チェックの追加",
      "description": "getSavedCardsのレスポンスで savedCards.length === 0 の場合の処理を追加。配列の要素に直接アクセスする前に長さチェック。",
      "breaking": false,
      "code_change_required": true
    },
    {
      "platform": "web",
      "task": "空の場合のUI表示",
      "description": "「まだ名刺を保存していません」などの適切なメッセージを表示",
      "breaking": false,
      "code_change_required": true
    },
    {
      "platform": "ios",
      "task": "空配列チェックの追加",
      "description": "getSavedCardsのレスポンスで savedCards.count == 0 の場合の処理を追加",
      "breaking": false,
      "code_change_required": true
    },
    {
      "platform": "ios",
      "task": "空の場合のUI表示",
      "description": "「まだ名刺を保存していません」などの適切なメッセージを表示",
      "breaking": false,
      "code_change_required": true
    }
  ],
  "security_notes": [
    "認証・認可への影響なし",
    "Firestore Rulesは既に正しく設定されている",
    "空のサブコレクションへのクエリは認証済みユーザーのみ可能"
  ],
  "breaking_changes": false,
  "notes_for_frontend": "getSavedCardsは、サインアップ直後（まだ1枚も名刺を保存していない場合）に空配列 [] を返します。これはエラーではなく正常な動作です。クライアント側では必ず savedCards.length をチェックしてから配列要素にアクセスしてください。また、空の場合は「まだ名刺を保存していません」のような適切なメッセージをUIに表示することを推奨します。",
  "backend_commit_sha": null,
  "pr_url": null,
  "related_issues": [],
  "estimated_effort": "30分（契約文書の追記 + テスト2件追加）"
}
