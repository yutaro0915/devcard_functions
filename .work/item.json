{
  "feature_name": "User Profile Update API",
  "backend_commit_sha": null,
  "status": "ready-for-review",
  "api_changes": [
    {
      "path": "updateProfile",
      "method": "Callable Function",
      "change_type": "add",
      "breaking": false,
      "details": "新規Callable Function追加: updateProfile(displayName?, bio?, photoURL?)",
      "reason": "ユーザーが自分のプロフィール情報を更新できるようにするため"
    }
  ],
  "security_notes": [
    "認証必須: Firebase Auth トークンが必要",
    "認可: ユーザーは自分自身のプロフィールのみ更新可能（request.auth.uidで判定）",
    "入力バリデーション: 型チェック（string）をHandler層で実施",
    "推奨: 文字列長バリデーション（displayName: 1-100, bio: 0-500）",
    "推奨: photoURL の URL形式検証とドメイン制限"
  ],
  "tests_required": [
    "成功系: 全フィールド更新（displayName, bio, photoURL）",
    "成功系: displayNameのみ更新",
    "成功系: bioのみ更新",
    "成功系: photoURLのみ更新",
    "成功系: /users と /public_cards 両方が更新されること",
    "成功系: updatedAt が更新されること",
    "失敗系: 未認証の場合 unauthenticated エラー",
    "失敗系: 全フィールド未指定の場合 invalid-argument エラー",
    "失敗系: displayName が非文字列の場合 invalid-argument エラー",
    "失敗系: bio が非文字列の場合 invalid-argument エラー",
    "失敗系: photoURL が非文字列の場合 invalid-argument エラー",
    "失敗系: ユーザー未存在の場合エラー",
    "失敗系: 公開名刺未存在の場合エラー"
  ],
  "client_work_items": [
    "Web: プロフィール編集画面の実装",
    "Web: updateProfile 呼び出しのAPIクライアント実装",
    "Web: エラーハンドリング（unauthenticated, invalid-argument, not-found）",
    "Web: 成功時のUI更新（楽観的更新 or リフレッシュ）",
    "iOS: プロフィール編集画面の実装",
    "iOS: updateProfile 呼び出しのAPIクライアント実装",
    "iOS: エラーハンドリング"
  ],
  "breaking_changes": false,
  "notes_for_frontend": "新規エンドポイント updateProfile を追加します。ユーザーは displayName, bio, photoURL を更新できます（全て任意フィールド、最低1つは指定必要）。エラーは unauthenticated, invalid-argument, not-found, internal の4種類です。更新後、getSavedCards等で取得される公開名刺情報にも反映されます。"
}
